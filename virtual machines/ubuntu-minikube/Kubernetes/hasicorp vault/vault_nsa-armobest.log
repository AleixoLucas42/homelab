
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

################################################################################
ApiVersion: v1
Kind: ServiceAccount
Name: vault-agent-injector
Namespace: vault

Controls: 1 (Failed: 1, action required: 0)

+----------+--------------------------------+------------------------------------+------------------------------------+
| SEVERITY |          CONTROL NAME          |                DOCS                |       ASSISTANT REMEDIATION        |
+----------+--------------------------------+------------------------------------+------------------------------------+
| Medium   | Automatic mapping of service   | https://hub.armosec.io/docs/c-0034 | automountServiceAccountToken=false |
|          | account                        |                                    |                                    |
+----------+--------------------------------+------------------------------------+------------------------------------+

################################################################################
ApiVersion: apps/v1
Kind: Deployment
Name: vault-agent-injector
Namespace: vault

Controls: 20 (Failed: 4, action required: 4)

+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+
| SEVERITY |          CONTROL NAME          |                DOCS                |                            ASSISTANT REMEDIATION                             |
+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+
| High     | Check if signature exists      | https://hub.armosec.io/docs/c-0237 | hashicorp/vault-k8s:1.1.0                                                    |
+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+
| Low      | Immutable container filesystem | https://hub.armosec.io/docs/c-0017 | spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem=true |
+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+
| Medium   | Automatic mapping of service   | https://hub.armosec.io/docs/c-0034 | spec.template.spec.automountServiceAccountToken=false                        |
|          | account                        |                                    |                                                                              |
+          +--------------------------------+------------------------------------+------------------------------------------------------------------------------+
|          | Ingress and Egress blocked     | https://hub.armosec.io/docs/c-0030 |                                                                              |
+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+

################################################################################
ApiVersion: apps/v1
Kind: StatefulSet
Name: vault
Namespace: vault

Controls: 20 (Failed: 4, action required: 4)

+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+
| SEVERITY |          CONTROL NAME          |                DOCS                |                            ASSISTANT REMEDIATION                             |
+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+
| High     | Check if signature exists      | https://hub.armosec.io/docs/c-0237 | hashicorp/vault:1.12.1                                                       |
+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+
| Low      | Immutable container filesystem | https://hub.armosec.io/docs/c-0017 | spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem=true |
+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+
| Medium   | Automatic mapping of service   | https://hub.armosec.io/docs/c-0034 | spec.template.spec.automountServiceAccountToken=false                        |
|          | account                        |                                    |                                                                              |
+          +--------------------------------+------------------------------------+------------------------------------------------------------------------------+
|          | Ingress and Egress blocked     | https://hub.armosec.io/docs/c-0030 |                                                                              |
+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+

Controls: 42 (Failed: 4, Passed: 28, Action Required: 10)
Failed Resources by Severity: Critical — 0, High — 2, Medium — 5, Low — 2

+----------+-------------------------------------------------------+------------------+---------------+---------------------+
| SEVERITY |                     CONTROL NAME                      | FAILED RESOURCES | ALL RESOURCES |    % RISK-SCORE     |
+----------+-------------------------------------------------------+------------------+---------------+---------------------+
| Critical | API server insecure port is enabled                   |        0         |       0       |         0%          |
| Critical | Disable anonymous access to Kubelet service           |        0         |       1       |         0%          |
| Critical | Enforce Kubelet client TLS authentication             |        0         |       2       |         0%          |
| High     | Forbidden Container Registries                        |        0         |       2       |  Action Required *  |
| High     | Resource limits                                       |        0         |       2       |         0%          |
| High     | Applications credentials in configuration files       |        0         |       4       |  Action Required *  |
| High     | Host PID/IPC privileges                               |        0         |       2       |         0%          |
| High     | HostNetwork access                                    |        0         |       2       |         0%          |
| High     | Insecure capabilities                                 |        0         |       2       |         0%          |
| High     | Privileged container                                  |        0         |       2       |         0%          |
| High     | CVE-2021-25742-nginx-ingress-snippet-annotation-vu... |        0         |       0       |         0%          |
| High     | Workloads with Critical vulnerabilities exposed to... |        0         |       0       | Action Required *** |
| High     | Workloads with RCE vulnerabilities exposed to exte... |        0         |       0       | Action Required *** |
| High     | CVE-2022-23648-containerd-fs-escape                   |        0         |       0       |         0%          |
| High     | CVE-2022-47633-kyverno-signature-bypass               |        0         |       0       |         0%          |
| High     | Verify image signature                                |        0         |       2       |  Action Required *  |
| High     | Check if signature exists                             |        2         |       2       |        100%         |
| Medium   | Exec into container                                   |        0         |       0       |         0%          |
| Medium   | Non-root containers                                   |        0         |       2       |         0%          |
| Medium   | Allow privilege escalation                            |        0         |       2       |         0%          |
| Medium   | Ingress and Egress blocked                            |        2         |       3       |         67%         |
| Medium   | Automatic mapping of service account                  |        3         |       5       |         60%         |
| Medium   | Cluster-admin binding                                 |        0         |       0       |         0%          |
| Medium   | Container hostPort                                    |        0         |       2       |         0%          |
| Medium   | Cluster internal networking                           |        0         |       1       |         0%          |
| Medium   | Linux hardening                                       |        0         |       2       |         0%          |
| Medium   | CVE-2021-25741 - Using symlink for arbitrary host ... |        0         |       0       |         0%          |
| Medium   | Sudo in container entrypoint                          |        0         |       2       |         0%          |
| Medium   | Portforwarding privileges                             |        0         |       0       |         0%          |
| Medium   | No impersonation                                      |        0         |       0       |         0%          |
| Medium   | Secret/ETCD encryption enabled                        |        0         |       0       | Action Required **  |
| Medium   | Audit logs enabled                                    |        0         |       0       | Action Required **  |
| Medium   | Images from allowed registry                          |        0         |       2       |  Action Required *  |
| Medium   | CVE-2022-0185-linux-kernel-container-escape           |        0         |       0       |         0%          |
| Medium   | CVE-2022-24348-argocddirtraversal                     |        0         |       0       |         0%          |
| Medium   | Workloads with excessive amount of vulnerabilities    |        0         |       0       | Action Required *** |
| Medium   | CVE-2022-0492-cgroups-container-escape                |        0         |       2       |         0%          |
| Low      | Immutable container filesystem                        |        2         |       2       |        100%         |
| Low      | Network mapping                                       |        0         |       1       |         0%          |
| Low      | Pods in default namespace                             |        0         |       2       |         0%          |
| Low      | PSP enabled                                           |        0         |       0       | Action Required **  |
| Low      | CVE-2022-3172-aggregated-API-server-redirect          |        0         |       0       |         0%          |
+----------+-------------------------------------------------------+------------------+---------------+---------------------+
|          |                   RESOURCE SUMMARY                    |        3         |      12       |       16.18%        |
+----------+-------------------------------------------------------+------------------+---------------+---------------------+
FRAMEWORKS: NSA (risk: 15.65), ArmoBest (risk: 16.18)

* Control missing configuration
** failed to get cloud provider, cluster: minikube
*** failed to pull image scanning data: credentials are not configured for any registry adaptor. for more information: https://hub.armosec.io/docs/configuration-of-image-vulnerabilities
