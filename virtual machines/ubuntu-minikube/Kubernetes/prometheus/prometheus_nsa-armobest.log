
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

################################################################################
ApiVersion: apps/v1
Kind: StatefulSet
Name: prometheus-kube-prometheus-stack-prometheus
Namespace: prometheus

Controls: 20 (Failed: 3, action required: 4)

+----------+----------------------------+------------------------------------+---------------------------------------------------------------------+
| SEVERITY |        CONTROL NAME        |                DOCS                |                        ASSISTANT REMEDIATION                        |
+----------+----------------------------+------------------------------------+---------------------------------------------------------------------+
| High     | Check if signature exists  | https://hub.armosec.io/docs/c-0237 | quay.io/prometheus-operator/prometheus-config-reloader:v0.62.0      |
|          |                            |                                    | quay.io/prometheus/prometheus:v2.41.0                               |
+          +----------------------------+------------------------------------+---------------------------------------------------------------------+
|          | Resource limits            | https://hub.armosec.io/docs/c-0009 | spec.template.spec.containers[0].resources.limits.cpu=YOUR_VALUE    |
|          |                            |                                    | spec.template.spec.containers[0].resources.limits.memory=YOUR_VALUE |
+----------+----------------------------+------------------------------------+---------------------------------------------------------------------+
| Medium   | Ingress and Egress blocked | https://hub.armosec.io/docs/c-0030 |                                                                     |
+----------+----------------------------+------------------------------------+---------------------------------------------------------------------+

################################################################################
ApiVersion: apps/v1
Kind: Deployment
Name: kube-prometheus-stack-operator
Namespace: prometheus

Controls: 20 (Failed: 3, action required: 4)

+----------+--------------------------------+------------------------------------+---------------------------------------------------------+
| SEVERITY |          CONTROL NAME          |                DOCS                |                  ASSISTANT REMEDIATION                  |
+----------+--------------------------------+------------------------------------+---------------------------------------------------------+
| High     | Check if signature exists      | https://hub.armosec.io/docs/c-0237 | quay.io/prometheus-operator/prometheus-operator:v0.62.0 |
+----------+--------------------------------+------------------------------------+---------------------------------------------------------+
| Medium   | Automatic mapping of service   | https://hub.armosec.io/docs/c-0034 | spec.template.spec.automountServiceAccountToken=false   |
|          | account                        |                                    |                                                         |
+          +--------------------------------+------------------------------------+---------------------------------------------------------+
|          | Ingress and Egress blocked     | https://hub.armosec.io/docs/c-0030 |                                                         |
+----------+--------------------------------+------------------------------------+---------------------------------------------------------+

################################################################################
ApiVersion: apps/v1
Kind: DaemonSet
Name: kube-prometheus-stack-prometheus-node-exporter
Namespace: prometheus

Controls: 20 (Failed: 6, action required: 4)

+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+
| SEVERITY |          CONTROL NAME          |                DOCS                |                            ASSISTANT REMEDIATION                             |
+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+
| High     | Check if signature exists      | https://hub.armosec.io/docs/c-0237 | quay.io/prometheus/node-exporter:v1.5.0                                      |
+          +--------------------------------+------------------------------------+------------------------------------------------------------------------------+
|          | Host PID/IPC privileges        | https://hub.armosec.io/docs/c-0038 | spec.template.spec.hostPID                                                   |
+          +--------------------------------+------------------------------------+------------------------------------------------------------------------------+
|          | HostNetwork access             | https://hub.armosec.io/docs/c-0041 | spec.template.spec.hostNetwork                                               |
+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+
| Low      | Immutable container filesystem | https://hub.armosec.io/docs/c-0017 | spec.template.spec.containers[0].securityContext.readOnlyRootFilesystem=true |
+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+
| Medium   | Container hostPort             | https://hub.armosec.io/docs/c-0044 | spec.template.spec.containers[0].ports[0].hostPort                           |
+          +--------------------------------+------------------------------------+------------------------------------------------------------------------------+
|          | Ingress and Egress blocked     | https://hub.armosec.io/docs/c-0030 |                                                                              |
+----------+--------------------------------+------------------------------------+------------------------------------------------------------------------------+

################################################################################
ApiVersion: apps/v1
Kind: Deployment
Name: kube-prometheus-stack-kube-state-metrics
Namespace: prometheus

Controls: 20 (Failed: 2, action required: 4)

+----------+--------------------------------+------------------------------------+-------------------------------------------------------+
| SEVERITY |          CONTROL NAME          |                DOCS                |                 ASSISTANT REMEDIATION                 |
+----------+--------------------------------+------------------------------------+-------------------------------------------------------+
| Medium   | Automatic mapping of service   | https://hub.armosec.io/docs/c-0034 | spec.template.spec.automountServiceAccountToken=false |
|          | account                        |                                    |                                                       |
+          +--------------------------------+------------------------------------+-------------------------------------------------------+
|          | Ingress and Egress blocked     | https://hub.armosec.io/docs/c-0030 |                                                       |
+----------+--------------------------------+------------------------------------+-------------------------------------------------------+

Controls: 42 (Failed: 8, Passed: 24, Action Required: 10)
Failed Resources by Severity: Critical — 0, High — 6, Medium — 7, Low — 1

+----------+-------------------------------------------------------+------------------+---------------+---------------------+
| SEVERITY |                     CONTROL NAME                      | FAILED RESOURCES | ALL RESOURCES |    % RISK-SCORE     |
+----------+-------------------------------------------------------+------------------+---------------+---------------------+
| Critical | API server insecure port is enabled                   |        0         |       0       |         0%          |
| Critical | Disable anonymous access to Kubelet service           |        0         |       1       |         0%          |
| Critical | Enforce Kubelet client TLS authentication             |        0         |       2       |         0%          |
| High     | Forbidden Container Registries                        |        0         |       4       | Action Required **  |
| High     | Resource limits                                       |        1         |       4       |         25%         |
| High     | Applications credentials in configuration files       |        0         |       6       | Action Required **  |
| High     | Host PID/IPC privileges                               |        1         |       4       |         25%         |
| High     | HostNetwork access                                    |        1         |       4       |         25%         |
| High     | Insecure capabilities                                 |        0         |       4       |         0%          |
| High     | Privileged container                                  |        0         |       4       |         0%          |
| High     | CVE-2021-25742-nginx-ingress-snippet-annotation-vu... |        0         |       0       |         0%          |
| High     | Workloads with Critical vulnerabilities exposed to... |        0         |       0       | Action Required *** |
| High     | Workloads with RCE vulnerabilities exposed to exte... |        0         |       0       | Action Required *** |
| High     | CVE-2022-23648-containerd-fs-escape                   |        0         |       0       |         0%          |
| High     | CVE-2022-47633-kyverno-signature-bypass               |        0         |       0       |         0%          |
| High     | Verify image signature                                |        0         |       4       | Action Required **  |
| High     | Check if signature exists                             |        3         |       4       |         75%         |
| Medium   | Exec into container                                   |        0         |       0       |         0%          |
| Medium   | Non-root containers                                   |        0         |       4       |         0%          |
| Medium   | Allow privilege escalation                            |        0         |       4       |         0%          |
| Medium   | Ingress and Egress blocked                            |        4         |       5       |         80%         |
| Medium   | Automatic mapping of service account                  |        2         |       9       |         22%         |
| Medium   | Cluster-admin binding                                 |        0         |       0       |         0%          |
| Medium   | Container hostPort                                    |        1         |       4       |         25%         |
| Medium   | Cluster internal networking                           |        0         |       1       |         0%          |
| Medium   | Linux hardening                                       |        0         |       4       |         0%          |
| Medium   | CVE-2021-25741 - Using symlink for arbitrary host ... |        0         |       0       |         0%          |
| Medium   | Sudo in container entrypoint                          |        0         |       4       |         0%          |
| Medium   | Portforwarding privileges                             |        0         |       0       |         0%          |
| Medium   | No impersonation                                      |        0         |       0       |         0%          |
| Medium   | Secret/ETCD encryption enabled                        |        0         |       0       |  Action Required *  |
| Medium   | Audit logs enabled                                    |        0         |       0       |  Action Required *  |
| Medium   | Images from allowed registry                          |        0         |       4       | Action Required **  |
| Medium   | CVE-2022-0185-linux-kernel-container-escape           |        0         |       0       |         0%          |
| Medium   | CVE-2022-24348-argocddirtraversal                     |        0         |       0       |         0%          |
| Medium   | Workloads with excessive amount of vulnerabilities    |        0         |       0       | Action Required *** |
| Medium   | CVE-2022-0492-cgroups-container-escape                |        0         |       4       |         0%          |
| Low      | Immutable container filesystem                        |        1         |       4       |         25%         |
| Low      | Network mapping                                       |        0         |       1       |         0%          |
| Low      | Pods in default namespace                             |        0         |       4       |         0%          |
| Low      | PSP enabled                                           |        0         |       0       |  Action Required *  |
| Low      | CVE-2022-3172-aggregated-API-server-redirect          |        0         |       0       |         0%          |
+----------+-------------------------------------------------------+------------------+---------------+---------------------+
|          |                   RESOURCE SUMMARY                    |        4         |      16       |       15.32%        |
+----------+-------------------------------------------------------+------------------+---------------+---------------------+
FRAMEWORKS: NSA (risk: 16.00), ArmoBest (risk: 15.32)

* failed to get cloud provider, cluster: minikube
** Control missing configuration
*** failed to pull image scanning data: credentials are not configured for any registry adaptor. for more information: https://hub.armosec.io/docs/configuration-of-image-vulnerabilities
